<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <script type="text/javascript" src="./../util/popup.js"></script>
    <script type="text/javascript" src="./../util/timer.js"></script>
    <script type="text/javascript" src="./../util/scrollbar.js"></script>
    <script type="text/javascript" src="./../util/areacontrol.js"></script>
    <link rel="stylesheet" href="./../util/default.css" type="text/css">
    <link rel="stylesheet" href="./../util/popup.css" type="text/css">
    <link rel="stylesheet" href="./../util/scrollbar.css" type="text/css">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Order App</title>
</head>

<body class="default_text">
    <div id="Area_Top">
        <div id="showClock" class=" small_text shadow"></div>
    </div>
    <div id="Area_Tab">
        <div class="Item_Tab">
            <button id="Item_TabA" class="FullSize Btn default_text small_text Selected"
                onclick="selectTab('Area_Show', 'Item_Tab', 'A');">注文順</button>
        </div>
        <div class="Item_Tab">
            <button id="Item_TabB" class="FullSize Btn default_text small_text" onclick="selectTab('Area_Show', 'Item_Tab', 'B');">テーブル別</button>
        </div>
        <div class="Item_Tab">
            <button id="Item_TabC" class="FullSize Btn default_text small_text" onclick="selectTab('Area_Show', 'Item_Tab', 'C');">アイテム別</button>
        </div>
    </div>
    <div id="Area_ShowA" class="Area_Show"></div>
    <div id="Area_ShowB" class="Area_Show" style="display: none;"></div>
    <div id="Area_ShowC" class="Area_Show" style="display: none;"></div>

    <style>
        :root {
            /*Item_Tabの最大数*/
            --tab-amount: 3;
            /*Item_Menuを横に並べる最大数*/
            --item-max-amount: 4;
            /*Tableを横に並べる最大数*/
            --table-max-amount: 20;
            /*色指定*/
            --use-color-a1: rgba(36, 50, 80, 1.0);
            --use-color-a2: rgba(36, 50, 80, 0.9);
            --use-color-a3: rgba(36, 50, 80, 0.5);
            --use-color-b1: rgba(88, 94, 170, 0.8);
            --use-color-b2: rgba(88, 94, 170, 0.9);
            --use-color-c1: rgba(101, 154, 210, 0.7);
        }

        body {
            background-color: black;
            background-image: url("img/back.jpg");
            background-size: cover;
            user-select: none;
        }

        #showClock {
            width: 15vw;
        }

        #Area_Top {
            display: flex;
            position: absolute;
            top: 0vh;
            left: 0vw;
            width: 100vw;
            height: 6vh;
        }

        #Area_Tab {
            display: grid;
            grid-template-columns: repeat(var(--tab-amount), 1fr);
            gap: 5px;
            position: absolute;
            top: 6vh;
            left: 0vw;
            width: 100vw;
            height: 8vh;
        }

        .Area_Show {
            position: absolute;
            top: 18vh;
            left: 1vw;
            width: 98vw;
            height: 80vh;
        }

        #Area_ShowB {
            display: grid;
            grid-template-columns: repeat(var(--table-max-amount), 1fr);
            gap: 5px;
            overflow-x: scroll;
            overflow-y: hidden;
        }

        #Area_ShowC {
            display: grid;
            grid-template-columns: repeat(var(--item-max-amount), 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 5px;
            overflow-x: hidden;
            overflow-y: scroll;
        }

        #Area_Tab {
            background-color: var(--use-color-a3);
            border-top: 3px solid var(--use-color-a1);
            border-bottom: 3px solid var(--use-color-a1);
        }

        .Item_Tab {
            margin: 5px;
        }

        /* .Item_Menu {
            background-color: var(--use-color-b1);
            margin: 5px;
            width: 25vw;
            border-radius: 30px;
            border: solid 3px var(--use-color-a1);
        } */

        .Item_ShowB {
            /* display: inline-block; */
            background-color: var(--use-color-b1);
            width: 20vw;
            height: 70vh;
            border-radius: 30px;
            border: solid 3px var(--use-color-a1);
            /* display: flex; */
        }

        .Item_ShowC {
            background-color: var(--use-color-b1);
            height: 10vh;
            border-radius: 30px;
            border: solid 3px var(--use-color-a1);
            display: flex;
        }

        .FullSize {
            width: 100%;
            height: 100%;
        }

        .sidehalf_div {
            width: 45%;
            height: 100%;
        }

        .Menu_Img {
            background-size: cover;
        }

        .Menu_Img {
            border-radius: 30px 0px 0px 30px;
        }

        .Menu_Title {
            width: 100%;
            height: 35%;
            margin-top: 5%;
        }

        .ShowC_Value {
            width: calc(40% - 35px);
        }

        .mBtn {
            width: 35px;
            height: 35px;
            margin-right: 10%;
            margin-left: 20%;
        }

        .pBtn {
            width: 35px;
            height: 35px;
            margin-right: 20%;
            margin-left: 10%;
        }

        .ShowC_Value {
            position: relative;
            left: 4vw;
            top: 1vh;
        }

        .Btn {
            background-color: var(--use-color-a2);
            color: white;
            text-shadow: none;
            text-align: center;
            border: solid 3px white;
            border-radius: 20px;
        }

        .Btn:hover {
            background-color: var(--use-color-c1);
        }

        .Selected {
            background-color: var(--use-color-c1);
        }
    </style>

    <script>

        const TableList = [
            { order_id: 1, created_at: "2023/12/17 15:00:00" },
            { order_id: 2, created_at: "2023/12/17 16:00:00" },
            { order_id: 3, created_at: "2023/12/17 17:00:00" },
            { order_id: 4, created_at: "2023/12/17 18:00:00" },
            { order_id: 5, created_at: "2023/12/17 15:00:00" },
            { order_id: 6, created_at: "2023/12/17 16:00:00" },
            { order_id: 7, created_at: "2023/12/17 17:00:00" },
            { order_id: 8, created_at: "2023/12/17 18:00:00" },
            { order_id: 9, created_at: "2023/12/17 15:00:00" },
            { order_id: 10, created_at: "2023/12/17 16:00:00" },
            { order_id: 11, created_at: "2023/12/17 17:00:00" },
            { order_id: 12, created_at: "2023/12/17 18:00:00" },
        ]
        const ItemList = [
            { type: "ShowC", No: 0, tab: "", name: "さくらんぼ", price: 100, img: "img/menuA.jpg" },
            { type: "ShowC", No: 1, tab: "", name: "いちご", price: 100, img: "img/menuA.jpg" },
            { type: "ShowC", No: 2, tab: "", name: "ぶどう", price: 100, img: "img/menuA.jpg" },
            { type: "ShowC", No: 3, tab: "", name: "デコポン", price: 100, img: "img/menuA.jpg" },
            { type: "ShowC", No: 4, tab: "", name: "かき", price: 100, img: "img/menuA.jpg" },
            { type: "ShowC", No: 5, tab: "", name: "りんご", price: 100, img: "img/menuA.jpg" },
            { type: "ShowC", No: 6, tab: "", name: "なし", price: 100, img: "img/menuB.jpg" },
            { type: "ShowC", No: 7, tab: "", name: "もも", price: 100, img: "img/menuB.jpg" },
            { type: "ShowC", No: 8, tab: "", name: "パイナップル", price: 100, img: "img/menuB.jpg" },
            { type: "ShowC", No: 9, tab: "", name: "メロン", price: 100, img: "img/menuC.jpg" },
            { type: "ShowC", No: 10, tab: "", name: "スイカ", price: 100, img: "img/menuC.jpg" },
        ]
        const OrderList = [
            { No: 0, order_id: 1, item_no: 0, name: "さくらんぼ", amount: 1, created_at: "2023/12/17 15:20:00", updated_at: "2023/12/17 15:20:00" },
            { No: 1, order_id: 2, item_no: 1, name: "いちご", amount: 2, created_at: "2023/12/17 15:21:00", updated_at: "2023/12/17 15:21:00" },
            { No: 2, order_id: 1, item_no: 4, name: "かき", amount: 3, created_at: "2023/12/17 15:23:00", updated_at: "2023/12/17 15:23:00" },
            { No: 3, order_id: 4, item_no: 3, name: "デコポン", amount: 2, created_at: "2023/12/17 15:25:00", updated_at: "2023/12/17 15:27:00" },
            { No: 4, order_id: 3, item_no: 1, name: "いちご", amount: 2, created_at: "2023/12/17 15:27:00", updated_at: "2023/12/17 15:27:00" },
            { No: 5, order_id: 2, item_no: 6, name: "なし", amount: 1, created_at: "2023/12/17 15:29:00", updated_at: "2023/12/17 15:29:00" },
            { No: 6, order_id: 1, item_no: 5, name: "りんご", amount: 3, created_at: "2023/12/17 15:30:00", updated_at: "2023/12/17 15:32:00" },
            { No: 7, order_id: 2, item_no: 0, name: "さくらんぼ", amount: 1, created_at: "2023/12/17 15:35:00", updated_at: "2023/12/17 15:35:00" },
        ]

        setInterval('showClock("showClock")', 1000);

        function addTable(Type = "ShowB", order_id, created_at) {
            var Item = document.createElement('div');
            Item.className = `Item_${Type}`;
            Item.innerHTML = `${order_id} ${created_at}`;
            document.getElementById("Area_ShowB").appendChild(Item);
        }

        // function addTabArea(No) {
        //     const newMenu = document.createElement('div');
        //     newMenu.id = `Area_Menu${TabList[No].tab}`;
        //     newMenu.className = 'Area_Menu';
        //     if (No > 0) {
        //         newMenu.style.display = 'none';
        //     }
        //     document.body.appendChild(newMenu);
        // }

        function addItem(Type = "Menu", No, Tab = "A", Name = "Menu", Price = 0, Img_URL = "") {
            var Item = document.createElement('div');
            Item.className = `Item_${Type}`;

            var div_1st = document.createElement('div');
            var div_2nd = document.createElement('div');

            var Img = document.createElement('div');
            Img.className = `Menu_Img FullSize Menu_Img${Type}`;
            Img.style.backgroundImage = `url("${Img_URL}")`;
            if (Type != "History") {
                Img.setAttribute("onclick", `add(${No},["Menu_Value","Confirm_Value"]);`);
            }

            var Menu_Title = document.createElement('div');
            Menu_Title.className = "Menu_Title";
            Menu_Title.innerHTML = Name;

            var Menu_Operate = document.createElement('div');
            Menu_Operate.className = "Menu_Operate";

            var subBtn = document.createElement('button');
            subBtn.innerHTML = '-';
            subBtn.className = "mBtn Btn default_text small_text";
            subBtn.id = `sub${No}`;
            subBtn.setAttribute("onclick", `sub(${No},["Menu_Value","Confirm_Value"]);`);

            var value = document.createElement('div');
            value.className = `${Type}_Value middle_text Menu${No}`;

            var addBtn = document.createElement('button');
            addBtn.innerHTML = '+';
            addBtn.className = "pBtn Btn default_text small_text";
            addBtn.id = `add${No}`;
            addBtn.setAttribute("onclick", `add(${No},["Menu_Value","Confirm_Value"]);`);

            if (Type == "Menu") {
                div_1st.className = "upper_div";
                div_2nd.className = "lower_div";
                value.innerHTML = "0";
                var observer = new MutationObserver(function (mutationsList, observer) {
                    for (var mutation of mutationsList) {
                        var length = document.querySelectorAll(`.Confirm_Value.Menu${No}`).length;
                        if (mutation.type === 'childList' && length === 0 && value.innerHTML === "1") {
                            // value.innerHTMLが1に変わったときの処理
                            addItem(Type = "Confirm", No, Tab = "", Name, Price, Img_URL);
                        }
                    }
                });
                // MutationObserver を value 要素に対して設定
                observer.observe(value, { childList: true, subtree: true });
            } else if (Type == "Confirm") {
                div_1st.className = "sidehalf_div";
                div_2nd.className = "sidehalf_div";
                value.innerHTML = "1";
            } else if (Type == "History" || Type == "ShowC") {
                div_1st.className = "sidehalf_div";
                div_2nd.className = "sidehalf_div";
                value.innerHTML = "0";
            }

            if (Type != "History" && Type != "ShowC") {
                Menu_Operate.appendChild(subBtn);
            }
            Menu_Operate.appendChild(value);
            if (Type != "History" && Type != "ShowC") {
                Menu_Operate.appendChild(addBtn);
            }

            div_1st.appendChild(Img);
            div_2nd.appendChild(Menu_Title);
            div_2nd.appendChild(Menu_Operate);

            Item.appendChild(div_1st);
            Item.appendChild(div_2nd);

            document.getElementById(`Area_${Type}${Tab}`).appendChild(Item);
        }

        function loadItemList() {
            for (var No = 0; No < TableList.length; No++) {
                addTable("ShowB", TableList[No].order_id, TableList[No].created_at);
            }
            for (var No = 0; No < ItemList.length; No++) {
                addItem("ShowC", No, ItemList[No].tab, ItemList[No].name, ItemList[No].price, ItemList[No].img);
            }
            //3エリアにそれぞれorder内容を追加する処理を追加
        }
        window.onload = function () {
            loadItemList();
            addSideScroll("Area_ShowB");
        };

    </script>
</body>

</html>