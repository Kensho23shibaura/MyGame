<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <script type="text/javascript" src="./../util/popup.js"></script>
    <link rel="stylesheet" href="./../util/default.css" type="text/css">
    <link rel="stylesheet" href="./../util/popup.css" type="text/css">
    <link rel="stylesheet" href="./../util/scrollbar.css" type="text/css">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>Order App</title>
</head>

<body>
    <div id="Area_top">
        <div class="Item_Top">Top?</div>
        <div class="Item_Top">履歴?</div>
        <div class="Item_Top">time?</div>
        <div class="Item_Top">date?</div>
    </div>
    <div id="Area_Tab">
        <div class="Item_Tab">Tab1</div>
        <div class="Item_Tab">Tab2</div>
        <div class="Item_Tab">Tab3</div>
        <div class="Item_Tab">Tab4</div>
    </div>
    <div id="Area_Menu"></div>
    <div id="Area_Confirm">
        Confirm
        <!-- <div class="Item_Confirm">Menu01</div>
        <div class="Item_Confirm">Menu02</div>
        <div class="Item_Confirm">Menu03</div>
        <div class="Item_Confirm">Menu04</div> -->
        Sum Submit
    </div>

    <style>
        body {
            background-color: black;
        }

        #Area_Top {
            display: flex;
            position: absolute;
            top: 0vh;
            left: 0vw;
            width: 100vw;
            height: 6vh;
        }

        #Area_Tab {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            position: absolute;
            top: 6vh;
            left: 0vw;
            width: 100vw;
            height: 8vh;
        }

        #Area_Menu {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 5px;
            position: absolute;
            top: 16vh;
            left: 1vw;
            width: 78vw;
            height: 82vh;
            overflow-x: scroll;
            overflow-y: hidden;
        }

        #Area_Confirm {
            display: grid;
            grid-template-rows: repeat(6, 1fr);
            gap: 5px;
            position: absolute;
            top: 14vh;
            left: 80vw;
            width: 20vw;
            height: 86vh;
            overflow-y: scroll;
        }

        #Area_Top {
            background-color: white;
        }

        #Area_Tab {
            background-color: darkgreen;
        }

        /* #Area_Menu {
            background-color: black;
        } */

        #Area_Confirm {
            background-color: darkred;
        }

        .Item_Tab {
            background-color: white;
            margin: 5px;
        }

        .Item_Tab {
            background-color: green;
            margin: 5px;
        }

        .Item_Menu {
            background-color: rgba(58, 94, 231, 0.8);
            /* background-color: rgba(47, 74, 145, 0.8); */
            margin: 5px;
            width: 25vw;
            border-radius: 30px;
        }

        .Item_Confirm {
            background-color: red;
            margin: 5px;
            height: 10vh;
            border-radius: 30px;
            display: flex;
        }

        .upper_div {
            width: 100%;
            height: 70%;
        }

        .lower_div {
            width: 100%;
            height: 30%;
        }
        .lefter_div {
            width: 50%;
            height: 100%;
        }

        .righter_div {
            width: 50%;
            height: 100%;
        }

        .Menu_Img {
            width: 100%;
            height: 100%;
            background-size: cover;
            border-radius: 30px;
        }

        .Menu_Title {
            width: 100%;
            height: 35%;
            margin-top: 5%;
        }

        .Menu_Operate {
            display: flex;
            padding-left: 30%;
            padding-right: 30%;
        }

        .Menu_Value {
            width: 20%;
        }

        .pmBtn {
            background: rgba(55, 55, 55, 0.9);
            border-radius: 20px;
            color: white;
            width: 35px;
            height: 35px;
            margin-right: 10%;
            margin-left: 10%;
            text-shadow: none;
            text-align: center;
            border: solid 3px white;
        }
    </style>

    <script>
        function addItem_Menu(No, Name = "Menu", Price = 0, Img_URL) {
            var Item_Menu = document.createElement('div');
            Item_Menu.className = "Item_Menu";

            var upper_div = document.createElement('div');
            upper_div.className = "upper_div";

            var lower_div = document.createElement('div');
            lower_div.className = "lower_div";

            var Img = document.createElement('div');
            Img.style.backgroundImage = `url("${Img_URL}")`;
            Img.className = "Menu_Img";
            Img.setAttribute("onclick", `add(${No});`);

            var Menu_Title = document.createElement('div');
            Menu_Title.className = "Menu_Title default_text";
            Menu_Title.innerHTML = Name;

            var Menu_Operate = document.createElement('div');
            Menu_Operate.className = "Menu_Operate";

            var subBtn = document.createElement('button');
            subBtn.innerHTML = '-';
            subBtn.className = "pmBtn default_text small_text";
            subBtn.id = `sub${No}`;
            subBtn.setAttribute("onclick", `sub(${No});`);

            var value = document.createElement('div');
            value.className = `Menu_Value default_text middle_text Menu${No}`;
            value.innerHTML = "0";
            var old_value = value.innerHTML;
            var observer = new MutationObserver(function (mutationsList, observer) {
                for (var mutation of mutationsList) {
                    if (mutation.type === 'childList' && old_value ==="0" && value.innerHTML === "1") {
                        // value.innerHTMLが1に変わったときの処理
                        addItem_Confirm(No, Name, Price, Img_URL);
                        old_value = value.innerHTML;
                    }
                }
            });

            // MutationObserver を value 要素に対して設定
            observer.observe(value, { childList: true, subtree: true });

            var addBtn = document.createElement('button');
            addBtn.innerHTML = '+';
            addBtn.className = "pmBtn default_text small_text";
            addBtn.id = `add${No}`;
            addBtn.setAttribute("onclick", `add(${No});`);

            Menu_Operate.appendChild(subBtn);
            Menu_Operate.appendChild(value);
            Menu_Operate.appendChild(addBtn);

            upper_div.appendChild(Img);
            lower_div.appendChild(Menu_Title);
            lower_div.appendChild(Menu_Operate);

            Item_Menu.appendChild(upper_div);
            Item_Menu.appendChild(lower_div);

            document.getElementById('Area_Menu').appendChild(Item_Menu);
        }

        addItem_Menu(0, "さくらんぼ", 100, "img/menu6.jpg");
        addItem_Menu(1, "いちご", 100, "img/menu6.jpg");
        addItem_Menu(2, "ぶどう", 100, "img/menu6.jpg");
        addItem_Menu(3, "デコポン", 100, "img/menu6.jpg");
        addItem_Menu(4, "かき", 100, "img/menu6.jpg");
        addItem_Menu(5, "りんご", 100, "img/menu6.jpg");
        addItem_Menu(6, "なし", 100, "img/menu6.jpg");

        function addItem_Confirm(No, Name = "Menu", Price = 0, Img_URL) {
            var Item_Confirm = document.createElement('div');
            Item_Confirm.className = "Item_Confirm";

            var upper_div = document.createElement('div');
            upper_div.className = "lefter_div";

            var lower_div = document.createElement('div');
            lower_div.className = "righter_div";

            var Img = document.createElement('div');
            Img.style.backgroundImage = `url("${Img_URL}")`;
            Img.className = "Menu_Img";
            Img.setAttribute("onclick", `add(${No});`);

            var Menu_Title = document.createElement('div');
            Menu_Title.className = "Menu_Title default_text";
            Menu_Title.innerHTML = Name;

            var Menu_Operate = document.createElement('div');
            Menu_Operate.className = "Menu_Operate";

            var subBtn = document.createElement('button');
            subBtn.innerHTML = '-';
            subBtn.className = "pmBtn default_text small_text";
            subBtn.id = `sub${No}`;
            subBtn.setAttribute("onclick", `sub(${No});`);

            var value = document.createElement('div');
            value.className = `Confirm_Value default_text middle_text Menu${No}`;
            // value.className = "Confirm_Value default_text middle_text";
            value.innerHTML = "1";

            var addBtn = document.createElement('button');
            addBtn.innerHTML = '+';
            addBtn.className = "pmBtn default_text small_text";
            addBtn.id = `add${No}`;
            addBtn.setAttribute("onclick", `add(${No});`);

            Menu_Operate.appendChild(subBtn);
            Menu_Operate.appendChild(value);
            Menu_Operate.appendChild(addBtn);

            upper_div.appendChild(Img);
            lower_div.appendChild(Menu_Title);
            lower_div.appendChild(Menu_Operate);

            Item_Confirm.appendChild(upper_div);
            Item_Confirm.appendChild(lower_div);

            document.getElementById('Area_Confirm').appendChild(Item_Confirm);
        }

        // addItem_Confirm(0, "プレーン", 100, "img/menu6.jpg");
        // addItem_Confirm(1, "ぶどう", 100, "img/menu6.jpg");
        // addItem_Confirm(2, "プレーン", 100, "img/menu6.jpg");
        // addItem_Confirm(3, "ぶどう", 100, "img/menu6.jpg");
        // addItem_Confirm(4, "プレーン", 100, "img/menu6.jpg");
        // addItem_Confirm(5, "ぶどう", 100, "img/menu6.jpg");

        // 数量の増減メソッド
        function add(No) {
            var Menu_Value = document.getElementsByClassName(`Menu${No}`);
            Array.from(Menu_Value).forEach(function (element) {
                element.innerHTML++;
            })
        }
        function sub(No) {
            var Menu_Value = document.getElementsByClassName(`Menu${No}`);
            Array.from(Menu_Value).forEach(function (element) {
                if (parseInt(element.innerHTML) > 0) {
                    element.innerHTML--;
                }
            })
            // var Menu_Value = document.getElementsByClassName('Menu_Value');
            // var Confirm_Value = document.getElementsByClassName('Confirm_Value');
            // if (parseInt(Menu_Value[num].innerHTML) > 0) {
            //     Menu_Value[num].innerHTML--;
            //     Confirm_Value[num].innerHTML--;
            // }
        }


    </script>
</body>

</html>