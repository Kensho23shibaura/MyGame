<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <script type="text/javascript" src="./../util/popup.js"></script>
    <link rel="stylesheet" href="./../util/default.css" type="text/css">
    <link rel="stylesheet" href="./../util/popup.css" type="text/css">
    <link rel="stylesheet" href="./../util/scrollbar.css" type="text/css">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>Order App</title>
</head>

<body>
    <div id="Area_Top">
        <div class="Item_Top">Top?</div>
        <div class="Item_Top">履歴?</div>
        <div class="Item_Top">time?</div>
        <div class="Item_Top">date?</div>
    </div>
    <div id="Area_Tab">
        <div class="Item_Tab">
            <button class="Tab_Button" onclick="showTab('MenuA')">MenuA</button>
        </div>
        <div class="Item_Tab">
            <button class="Tab_Button" onclick="showTab('MenuB')">MenuB</button>
        </div>
        <div class="Item_Tab">
            <button class="Tab_Button" onclick="showTab('MenuC')">MenuC</button>
        </div>
        <div class="Item_Tab">
            <button class="Tab_Button" onclick="showTab('MenuD')">MenuD</button>
        </div>
    </div>
    <div id="Area_MenuA" class="Area_Menu"></div>
    <div id="Area_MenuB" class="Area_Menu" style="display: none;"></div>
    <div id="Area_MenuC" class="Area_Menu" style="display: none;"></div>
    <div id="Area_MenuD" class="Area_Menu" style="display: none;"></div>
    <div id="Area_Confirm">
        <div class="Item_Tab">
            <button class="" onclick="resetConfirm()">リセット</button>
            <button class="" onclick="resetConfirm()">送信(リセット)</button>
            Confirm
            Sum
        </div>
    </div>

    <style>
        body {
            background-color: black;
        }

        #Area_Top {
            display: flex;
            position: absolute;
            top: 0vh;
            left: 0vw;
            width: 100vw;
            height: 6vh;
        }

        #Area_Tab {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            position: absolute;
            top: 6vh;
            left: 0vw;
            width: 100vw;
            height: 8vh;
        }

        .Area_Menu {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 5px;
            position: absolute;
            top: 16vh;
            left: 1vw;
            width: 78vw;
            height: 82vh;
            overflow-x: scroll;
            overflow-y: hidden;
        }

        #Area_Confirm {
            display: grid;
            grid-template-rows: repeat(6, 1fr);
            gap: 5px;
            position: absolute;
            top: 14vh;
            left: 80vw;
            width: 20vw;
            height: 86vh;
            overflow-x: hidden;
            overflow-y: scroll;
        }

        #Area_Top {
            background-color: white;
        }

        #Area_Tab {
            background-color: darkgreen;
        }

        #Area_Confirm {
            background-color: darkred;
        }

        .Item_Top {
            background-color: white;
            margin: 5px;
        }

        .Item_Tab {
            background-color: green;
            margin: 5px;
        }

        .Item_Menu {
            background-color: rgba(58, 94, 231, 0.8);
            /* background-color: rgba(47, 74, 145, 0.8); */
            margin: 5px;
            width: 25vw;
            border-radius: 30px;
        }

        .Item_Confirm {
            background-color: red;
            margin: 5px;
            height: 10vh;
            border-radius: 30px;
            display: flex;
        }

        .upper_div {
            width: 100%;
            height: 70%;
        }

        .lower_div {
            width: 100%;
            height: 30%;
        }

        .lefter_div {
            width: 50%;
            height: 100%;
        }

        .righter_div {
            width: 50%;
            height: 100%;
        }

        .Menu_Img {
            width: 100%;
            height: 100%;
            background-size: cover;
            border-radius: 30px;
        }

        .Menu_Title {
            width: 100%;
            height: 35%;
            margin-top: 5%;
        }

        .Menu_Operate {
            display: flex;
            padding-left: 30%;
            padding-right: 30%;
        }

        .Menu_Value {
            width: 20%;
        }

        .pmBtn {
            background: rgba(55, 55, 55, 0.9);
            border-radius: 20px;
            color: white;
            width: 35px;
            height: 35px;
            margin-right: 10%;
            margin-left: 10%;
            text-shadow: none;
            text-align: center;
            border: solid 3px white;
        }
    </style>

    <script>

        function addItem(Type = "Menu", No, Tab = "A", Name = "Menu", Price = 0, Img_URL = "img/sample.jpg") {
            var Item = document.createElement('div');
            Item.className = `Item_${Type}`;

            var div_1st = document.createElement('div');
            var div_2nd = document.createElement('div');
            if (Type == "Menu") {
                div_1st.className = "upper_div";
                div_2nd.className = "lower_div";
            } else if (Type == "Confirm") {
                div_1st.className = "lefter_div";
                div_2nd.className = "righter_div";
            }

            var Img = document.createElement('div');
            Img.style.backgroundImage = `url("${Img_URL}")`;
            Img.className = "Menu_Img";
            Img.setAttribute("onclick", `add(${No});`);

            var Menu_Title = document.createElement('div');
            Menu_Title.className = "Menu_Title default_text";
            Menu_Title.innerHTML = Name;

            var Menu_Operate = document.createElement('div');
            Menu_Operate.className = "Menu_Operate";

            var subBtn = document.createElement('button');
            subBtn.innerHTML = '-';
            subBtn.className = "pmBtn default_text small_text";
            subBtn.id = `sub${No}`;
            subBtn.setAttribute("onclick", `sub(${No});`);

            var value = document.createElement('div');
            value.className = `${Type}_Value default_text middle_text Menu${No}`;
            if (Type == "Menu") {
                value.innerHTML = "0";
                var observer = new MutationObserver(function (mutationsList, observer) {
                    for (var mutation of mutationsList) {
                        var length = document.querySelectorAll(`.Confirm_Value.Menu${No}`).length;
                        if (mutation.type === 'childList' && length === 0 && value.innerHTML === "1") {
                            // value.innerHTMLが1に変わったときの処理
                            addItem(Type = "Confirm", No, Tab = "", Name, Price, Img_URL);
                        }
                    }
                });
                // MutationObserver を value 要素に対して設定
                observer.observe(value, { childList: true, subtree: true });
            } else if (Type == "Confirm") {
                value.innerHTML = "1";
            }

            var addBtn = document.createElement('button');
            addBtn.innerHTML = '+';
            addBtn.className = "pmBtn default_text small_text";
            addBtn.id = `add${No}`;
            addBtn.setAttribute("onclick", `add(${No});`);

            Menu_Operate.appendChild(subBtn);
            Menu_Operate.appendChild(value);
            Menu_Operate.appendChild(addBtn);

            div_1st.appendChild(Img);
            div_2nd.appendChild(Menu_Title);
            div_2nd.appendChild(Menu_Operate);

            Item.appendChild(div_1st);
            Item.appendChild(div_2nd);

            document.getElementById(`Area_${Type}${Tab}`).appendChild(Item);
        }

        addItem("Menu", 0, "A", "さくらんぼ", 100, "img/menu6.jpg");
        addItem("Menu", 1, "A", "いちご", 100, "img/menu6.jpg");
        addItem("Menu", 2, "A", "ぶどう", 100, "img/menu6.jpg");
        addItem("Menu", 3, "A", "デコポン", 100, "img/menu6.jpg");
        addItem("Menu", 4, "A", "かき", 100, "img/menu6.jpg");
        addItem("Menu", 5, "A", "りんご", 100, "img/menu6.jpg");
        addItem("Menu", 6, "A", "なし", 100, "img/menu6.jpg");
        addItem("Menu", 7, "A", "もも", 100, "img/menu6.jpg");
        addItem("Menu", 8, "A", "パイナップル", 100, "img/menu6.jpg");
        addItem("Menu", 9, "A", "メロン", 100, "img/menu6.jpg");
        addItem("Menu", 10, "A", "スイカ", 100, "img/menu6.jpg");

        //タブ切り替え
        function showTab(Tab = "MenuA") {
            var Area_Menu = document.getElementsByClassName("Area_Menu");
            Array.from(Area_Menu).forEach(function (element) {
                element.style.display = 'none';
            })
            document.getElementById(`Area_${Tab}`).style.display = 'grid';
        }

        //Confirmの初期化
        function resetConfirm() {
            var Menu_Value = document.getElementsByClassName("Menu_Value");
            var Confirm_Value = document.getElementsByClassName("Confirm_Value");
            Array.from(Menu_Value).forEach(function (element) {
                element.innerHTML = 0;
            })
            Array.from(Confirm_Value).forEach(function (element) {
                element.innerHTML = 0;
            })
            var Area_Confirm = document.getElementById("Area_Confirm");
            var Item_Confirm = document.getElementsByClassName("Item_Confirm");
            Array.from(Item_Confirm).forEach(function (element) {
                Area_Confirm.removeChild(element);
            })
        }

        // 数量の増減メソッド
        function add(No) {
            var Menu_Value = document.getElementsByClassName(`Menu${No}`);
            Array.from(Menu_Value).forEach(function (element) {
                element.innerHTML++;
            })
        }
        function sub(No) {
            var Menu_Value = document.getElementsByClassName(`Menu${No}`);
            Array.from(Menu_Value).forEach(function (element) {
                if (parseInt(element.innerHTML) > 0) {
                    element.innerHTML--;
                }
            })
        }

    </script>
</body>

</html>