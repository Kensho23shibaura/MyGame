<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/javascript" src="./../util/popup.js"></script>
  <script type="text/javascript" src="./../util/audio.js"></script>
  <link rel="stylesheet" href="./../util/default.css" type="text/css">
  <link rel="stylesheet" href="./../util/popup.css" type="text/css">
  <script type="text/javascript" src="popup2.js"></script>
  <link rel="stylesheet" href="popup2.css" type="text/css">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Percent Balloon</title>
  <style>
    :root {
      /*è‰²æŒ‡å®š*/
      --use-color-a2: rgba(36, 50, 80, 0.9);
      --use-color-c1: rgba(101, 154, 210, 0.7);
    }

    html {
      touch-action: manipulation;
    }

    body {
      background-image: url("img/sky.jpg");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      height: 100vh;
      user-select: none;
    }

    .grid-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: 5px;
    }

    .website-box {
      position: relative;
      border: 1px solid #ccc;
      padding: 10px;
      height: 30vh;
      text-align: center;
      background-color: rgba(58, 94, 231, 0.8);
    }

    .website-box2 {
      position: relative;
      padding: 10px;
      height: 20vh;
      text-align: center;
    }

    button {
      margin-top: 10px;
    }

    .website-group {
      position: absolute;
      top: 1px;
      left: 5px;
      width: 10vw;
      height: 10vh;
      margin: 3px;
      padding: 10px;
    }

    .health-bar-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .health-bar {
      width: 30vw;
      height: 30px;
      background-color: #ddd;
      position: absolute;
      top: 15vh;
      left: 0.5vw;
    }

    .current-health {
      height: 100%;
      background-color: #4CAF50;
      transition: width 0.5s;
    }

    .health-text {
      margin-top: 5vh;
    }

    .answer-text-input {
      width: 25vw;
      position: absolute;
      top: 23vh;
      left: 2.5vw;
    }

    .correct-answer {
      position: fixed;
      bottom: 0vh;
      left: 0vw;
      background-color: rgba(255, 255, 255, 0.3);
      border: rgba(255, 255, 255, 0.1);
      width: 40px;
    }

    .action_button {
      width: 10vw;
      height: 5vh;
      border-radius: 15px;
      margin: calc(5px);
    }

    #muteBtn {
      width: calc(20vw + 10px);
    }

    .Btn {
      background-color: var(--use-color-a2);
      color: white;
      text-shadow: none;
      text-align: center;
      border: solid 3px white;
      border-radius: 20px;
    }

    .Btn:hover {
      background-color: var(--use-color-c1);
    }

    .Selected {
      background-color: var(--use-color-c1);
    }
  </style>
</head>

<body class="default_text">

  <div class="grid-container">
    <div class="website-box">
      <button class="Btn website-group default_text small_text" onclick="">Group A</button>
      <div class="health-text large_text shadow" id="health-text-1">100</div>
      <div class="health-bar">
        <div class="current-health" id="health-bar-1"></div>
      </div>
      <input type="number" class="answer-text-input default_text small_text" id="answerInput1" placeholder="å›ç­”" min="0"
        step="1" max="100">
    </div>

    <div class="website-box">
      <button class="Btn website-group default_text small_text" onclick="">Group B</button>
      <div class="health-text large_text shadow" id="health-text-2">100</div>
      <div class="health-bar">
        <div class="current-health" id="health-bar-2"></div>
      </div>
      <input type="number" class="answer-text-input default_text small_text" id="answerInput2" placeholder="å›ç­”" min="0"
        step="1" max="100">
    </div>

    <div class="website-box">
      <button class="Btn website-group default_text small_text" onclick="">Group C</button>
      <div class="health-text large_text shadow" id="health-text-3">100</div>
      <div class="health-bar">
        <div class="current-health" id="health-bar-3"></div>
      </div>
      <input type="number" class="answer-text-input default_text small_text" id="answerInput3" placeholder="å›ç­”" min="0"
        step="1" max="100">
    </div>

    <div class="website-box">
      <button class="Btn website-group default_text small_text" onclick="">Group D</button>
      <div class="health-text large_text shadow" id="health-text-4">100</div>
      <div class="health-bar">
        <div class="current-health" id="health-bar-4"></div>
      </div>
      <input type="number" class="answer-text-input default_text small_text" id="answerInput4" placeholder="å›ç­”" min="0"
        step="1" max="100">
    </div>

    <div class="website-box">
      <button class="Btn website-group default_text small_text" onclick="">Group E</button>
      <div class="health-text large_text shadow" id="health-text-5">100</div>
      <div class="health-bar">
        <div class="current-health" id="health-bar-5"></div>
      </div>
      <input type="number" class="answer-text-input default_text small_text" id="answerInput5" placeholder="å›ç­”" min="0"
        step="1" max="100">
    </div>

    <div class="website-box">
      <button class="Btn website-group default_text small_text" onclick="">Group F</button>
      <div class="health-text large_text shadow" id="health-text-6">100</div>
      <div class="health-bar">
        <div class="current-health" id="health-bar-6"></div>
      </div>
      <input type="number" class="answer-text-input default_text small_text" id="answerInput6" placeholder="å›ç­”" min="0"
        step="1" max="100">
    </div>

  </div>

  <div class="website-box2">
    <button id="questionText" class="Btn action_button default_text small_text" onclick="nextQuestion()">ä¾‹é¡Œ</button>
    <button id="questionBtn" class="Btn action_button default_text small_text" onclick="showQuestion()">å‡ºé¡Œ</button>
    <button id="answerBtn" class="Btn action_button default_text small_text"
      onclick="showAlert('','ç­”ãˆã‚’è¡¨ç¤ºã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹?','confirm','showAnswer()')">ç­”ãˆ</button>
    <button id="reflectBtn" class="Btn action_button default_text small_text"
      onclick="showAlert('','çµæœã‚’åæ˜ ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹?','confirm','decreaseHealth()')">åæ˜ </button>
    <br>
    <div class="large_text shadow" id="correctAnswer">æ­£è§£ï¼š??%</div>
    <br>
    <button id="addBtn" class="Btn action_button default_text small_text" onclick="addHealth(50)">ä¸€å¾‹</button>
    <button id="resetBtn" class="Btn action_button default_text small_text"
      onclick="showAlert('','åˆæœŸåŒ–ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹?','confirm','resetHealth()')">é–‹å§‹</button>
    <button class="Btn action_button default_text small_text" onclick="mute(this)" id="muteBtn">ğŸ”‡ãƒŸãƒ¥ãƒ¼ãƒˆä¸­</button>
    <input type="password" class="correct-answer" id="correctAnswerInput" placeholder="æ­£è§£" min="0" step="1"
      max="100"><br><br>
  </div>
  <!-- <br><br><br><br><br>
  <div class="website-box2">
  </div> -->


  <script>
    var muting = true;
    function mute(obj) {
      if (muting == true) {
        muting = false;
        obj.innerHTML = "ğŸµã€€é€šçŸ¥ä¸­ã€€"
      } else if (muting == false) {
        stopAllAlarms();
        muting = true;
        obj.innerHTML = "ğŸ”‡ãƒŸãƒ¥ãƒ¼ãƒˆä¸­";
      }
    }

    let questionNumber = 0;
    let startHealth = 200;
    let QAdict = {
      "2022å¹´ã®å›½å†…å‘ã‘æ–°è»Šè²©å£²å°æ•°ã€<br>ãƒˆãƒ¨ã‚¿è»Šã®ã‚·ã‚§ã‚¢ã¯ä½•%?": 47,
      "æ—¥æœ¬ã®ç±³ã®åç©«é‡ã€<br>æ–°æ½ŸçœŒãŒå ã‚ã‚‹å‰²åˆã€ä½•%?": 8,
      "æ—¥æœ¬ã§è½ã¨ã—ãŸè²¡å¸ƒãŒ<br>ç„¡äº‹ã«æˆ»ã£ã¦ãã‚‹ç¢ºç‡ã€ä½•%?": 63,
      "50ä»£ç”·æ€§ã€‚<br>éå»ã«è·å‹™è³ªå•ã‚’ã•ã‚ŒãŸã“ã¨ãŒã‚ã‚‹äººã€ä½•%?": 44,
      "åƒãå¥³æ€§ã«èã„ãŸ! <br>å®ãã˜ã§1å„„å††ä»¥ä¸Šå½“ãŸã£ãŸã‚‰<br>ä»Šã®ä»•äº‹ã‚’è¾ã‚ã‚‹äººã€ä½•%?": 68,
      "ã“ã‚Œã¾ã§ã«ä¼šç¤¾ã‚’<br>ã€Œã‚ºãƒ«ä¼‘ã¿ã€ã—ãŸã“ã¨ãŒã‚ã‚‹äººã¯ä½•%?": 38,
      "è‡ªè²©æ©Ÿã®ä¸‹ã«ãŠé‡‘ãŒè½ã¡ã¦ã„ã‚‹ç¢ºç‡ã€ä½•%?": 10,
      "é£›è¡Œæ©Ÿå†…<br>ã€ŒãŠå®¢æ§˜ã®ä¸­ã«ãŠåŒ»è€…æ§˜ã¯ã„ã¾ã›ã‚“ã‹!?ã€<br>â‡’ã„ã‚‹ç¢ºç‡ã€ä½•%?": 49,
      "å…±åƒãå¤«å©¦ã€‚<br>ãŠäº’ã„ã®åå…¥ã‚’çŸ¥ã‚‰ãªã„äººã¯ä½•%?": 12,

      "20~30ä»£ã€‚<br>LINEã§å‘Šç™½ã—ãŸã“ã¨ã‚ã‚‹äººã€ä½•%?": 44,
      "ãŠã¿ãã˜ã‚’å¼•ã„ãŸã‚‰<br>ãªã‚“ã¨ã€Œå¤§å‡¶ã€!!ã“ã®ç¢ºç‡ã€ä½•%?(é¶´å²¡å…«å¹¡å®®)": 4,
      "18æ­³~26æ­³ã€‚<br>ã€Œå……å®Ÿã•ã›ãŸã„ã®ã¯ä»•äº‹ã‚ˆã‚Šãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ!ã€ã€ä½•%?": 68,
      "å¤«å©¦ã§åŒã˜ãƒ™ãƒƒãƒ‰ã§å¯ã¦ã„ã‚‹äººã®å‰²åˆã€ä½•%?": 28,
      "ã¿ãæ±ã®ä¸€ç•ªå¥½ããªå…·æã¯<br>ã€è±†è…ã€ã€ä½•%?": 11,
      "å¤§å­¦ç”Ÿã€‚<br>ã‚¢ãƒ«ãƒã‚¤ãƒˆã‚’ã—ãŸã“ã¨ãŒãªã„äººã¯ä½•%?(2022)": 4,
      "ã‚¹ãƒãƒ›ã‚’ãƒ•ã‚£ãƒ«ãƒ ã‚„ã‚±ãƒ¼ã‚¹ã§<br>ä¿è­·ã—ã¦ã„ã‚‹äººã€ä½•%?": 88,
      "æ—¥æœ¬ã®18æ­³ã€ç”ŸæˆAIã‚’<br>ä½¿ã£ãŸã“ã¨ãŒã‚ã‚‹äººã¯ä½•%?(2023/08)": 36,
      "10~30ä»£ã€‚ç›´è¿‘1ãƒµæœˆä»¥å†…ã«<br>ã‚¹ãƒãƒ›ã‚²ãƒ¼ãƒ ã§ãŠé‡‘ã‚’ä½¿ã£ãŸäººã€ä½•%?": 28,
      "æ—¥æœ¬å›½å†…ã®<br>iPhoneã‚·ã‚§ã‚¢ã€ä½•%?(2023/08)": 69,
      "å°ä¸­å­¦ç”Ÿã€‚<br>è¦ªã¨åŒã˜ä»•äº‹ã‚’ã—ãŸã„äººã¯ä½•%?": 35,
      "æ—¥æœ¬ã®å¹´æ¬¡æœ‰çµ¦ä¼‘æš‡å–å¾—ç‡ã¯ä½•%?(2022)": 62,
    }

    function nextQuestion() {
      questionNumber++;
      updateQuestionText();
    }

    function updateQuestionText() {
      const questionTextElement = document.getElementById('questionText');
      questionTextElement.textContent = questionNumber + 'å•ç›®';
    }

    function showQuestion() {
      if (muting == false) {
        const sound = playAlarm("img/question.mp3", false);
      }
      const questionTextElement = document.getElementById('questionText');
      showAlert2(questionTextElement.textContent, Object.keys(QAdict)[questionNumber]);
    }

    function showAnswer() {
      if (muting == false) {
        const sound = playAlarm("img/drumroll1.mp3", false);
      }
      animateNumber();
    }

    const numHealthBars = 6;
    let currentHealth = Array.from({ length: numHealthBars }, () => startHealth);
    updateHealthBars();

    function resetHealth() {
      currentHealth = Array.from({ length: numHealthBars }, () => startHealth);
      updateHealthBars();
      questionNumber = 1;
      updateQuestionText()
      for (let barNumber = 1; barNumber <= numHealthBars; barNumber++) {
        const inputAnswerInput = document.getElementById(`answerInput${barNumber}`);
        inputAnswerInput.value = "";
      }
    }
    function addHealth(value = 50) {
      for (let barNumber = 1; barNumber <= numHealthBars; barNumber++) {
        currentHealth[barNumber - 1] = currentHealth[barNumber - 1] + value;
      }
      updateHealthBars();
    }

    function decreaseHealth() {
      for (let barNumber = 1; barNumber <= numHealthBars; barNumber++) {
        const inputAnswerInput = document.getElementById(`answerInput${barNumber}`);
        const correctAnswer = document.getElementById('correctAnswerInput').value;
        if (inputAnswerInput.value == '') {
          continue;
        }
        const inputAnswer = parseInt(inputAnswerInput.value);
        if (inputAnswer == correctAnswer) {
          if (muting == false) {
            const sound = playAlarm("img/fanfare.mp3", false);
          }
        }
        const decreaseAmount = Math.abs(inputAnswer - correctAnswer);
        const newHealth = Math.max(0, currentHealth[barNumber - 1] - decreaseAmount);
        currentHealth[barNumber - 1] = newHealth;
        inputAnswerInput.value = "";
      }
      updateHealthBars();
    }

    function updateHealthBars() {
      for (let i = 1; i <= numHealthBars; i++) {
        const healthBar = document.getElementById(`health-bar-${i}`);
        const healthNumber = document.getElementById(`health-text-${i}`);
        healthBar.style.width = (currentHealth[i - 1] / (startHealth / 100)) + '%';
        healthNumber.textContent = currentHealth[i - 1];
        if (currentHealth[i - 1] <= 0) {
          healthNumber.style.color = "red";
        } else if (currentHealth[i - 1] <= 20) {
          healthNumber.style.color = "orange";
        } else {
          healthNumber.style.color = "black";
        }
      }
    }

    function set2fig(num) {
      if (num < 10) {
        return "0" + String(num);
      } else {
        return String(num);
      }
    }

    function animateNumber() {
      var inputNumber = document.getElementById('correctAnswerInput');
      if (Object.keys(QAdict).length >= questionNumber) {
        let firstQuestion = Object.keys(QAdict)[questionNumber];
        inputNumber.value = QAdict[firstQuestion];
      }
      const resultDisplay = document.getElementById('correctAnswer');
      const targetNumber = parseInt(inputNumber.value, 10) || 0;
      const animationDuration = 4000; // 4 seconds
      const animationInterval = 50; // Update every 50 milliseconds
      const steps = animationDuration / animationInterval;

      let currentNumber = 0;
      let stepCount = 0;

      const animationIntervalId = setInterval(() => {
        currentNumber = Math.floor(Math.random() * 100); // Random number between 0 and 99
        resultDisplay.textContent = "æ­£è§£ï¼š" + set2fig(currentNumber) + "%";
        stepCount++;

        if (stepCount >= steps) {
          clearInterval(animationIntervalId);
          resultDisplay.textContent = "æ­£è§£ï¼š" + set2fig(targetNumber) + "%";
          if (muting == false) {
            const sound = playAlarm("img/drumroll2.mp3", false);
          }
        }
      }, animationInterval);
    }

  </script>

</body>

</html>